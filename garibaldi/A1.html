<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="UTF-8">
  <title>GEOG 384 Group 6</title>
  <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
  <link rel="icon" type="image/x-icon"
      href="https://raw.githubusercontent.com/mapbox/assembly/publisher-staging/src/svgs/mapbox.svg">
  <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v3.8.0/mapbox-gl.js'></script>
  <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v3.8.0/mapbox-gl.css' rel='stylesheet' />
  <script src="https://cdn.jsdelivr.net/npm/mapbox-gl-globe-minimap@1.2.0/dist/bundle.js"></script>
  <script src="https://unpkg.com/scrollama"></script>
  <script src="https://unpkg.com/three@0.126.0/build/three.min.js"></script>
<script src="https://unpkg.com/three@0.126.0/examples/js/loaders/GLTFLoader.js"></script>


  <style>
    body {
      font-family: "Calibri", sans-serif;
      background-color: #f8f9fa;
      color: #202122;
    }
    header {
      background-color: #ffffff;
      border-bottom: 1px solid #a2a9b1;
      padding: 0.5em 1em;
      opacity: 0.85;
    }
    main {
      margin-left: 220px;
      padding: 1.5em;
      max-width: 800px;
    }
    footer {
      background-color: #ffffff;
      border-bottom: 1px solid #a2a9b1;
      opacity: 0.85;
    }
    header h1 {
      font-family: "Calibri", sans-serif;
      font-size: 25px;
      padding-bottom: 0.2em;
    }
    h2 {
      font-family: "Calibri", sans-serif;
      border-bottom: 1px solid #a2a9b1;
      padding-bottom: 0.2em;
      margin-top: 0px;
      font-size: 20px;
    }
    p {
      line-height: 25px;
      font-size: 15px;
    }
    a {
      color: #0645ad;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    a:visited {
      color: #0071bc;
    }
    sup {
      vertical-align: super;
      font-size: smaller;
    }

    #map {
      height: 100vh;
      width: 100vw;
      top:0;
      left: 0;
      z-index: 1;
      position: fixed;
      /* # identify specific ID */
      /* unique; only one element should have */
    }
    #story { 
      position:relative; 
      z-index:5; 
      padding: 2rem 1rem;
    }
    #features { 
      padding: 10vh 0 10vh; 
    }

    .panel {
      position: relative;
      z-index: 5;
      max-width: 980px;
      margin: 0 auto;
      padding: 1.25rem 1.5rem;
      background: #fff;
      /* . is a class selector */
      /* applies this formatting to all */
    }

    .centered { 
      width: min(720px, 90vw); margin: 0 auto; 
    }
    .lefty { 
      width: 22vw; margin-left: -10vw; 
    }
    .righty { 
      width: 22vw; margin-left: 50vw; 
    }
    .fully { 
      width: 100%; margin: 0 auto; 
    }

.step {
  padding-bottom: 50vh;
}

.step div {
  background: rgba(255,255,255,0.8); 
  border: 1px solid #d0d5db;
  padding: 25px 50px;
  line-height: 25px;
  font-size: 13px;
  box-shadow: 0 1px 2px rgba(0,0,0,.03);
  transition: background 0.3s, color 0.3s;
  color: #202122;
}


.step iframe,
.step video,
.step img {
  opacity: 1 !important;     
  background: transparent;
  display: block;
  width: 100%;
  max-width: 100%;
}

    @media (max-width: 750px) {

        .centered,
        .lefty,
        .righty,
        .fully {
            width: 90vw;
            margin: 0 auto;
        }
    }

    .mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,
    .mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas {
        touch-action: unset;
    }

    .step iframe, 
    .step video {
  opacity: 1 !important;
}

  </style>
</head>
<body>

  <div id="map"></div>


  <header class="panel" id="header">
    <h1>GARIBALDI HELICOPTER TOURS</h1>
    <p>Welcome to Garibaldi Helicopter Tours, and more importantly to the trip of a lifetime!<br><br> We run helicopter tours of the Garibaldi Volcanic Range, located in beautiful British Columbia. Whether you are looking for a scenic getaway or your next intense hike, we have a route for you. Keep scrolling to get a virtual tour of what you could experience!</p>
  </header>
  
  <main id="map-section">
    <div id="story"></div>

  </main>

  <footer class="panel" id="refs">
    <h2>Credits & sources</h2>
    <ol>
      <li id="silverthrone_cite"><a href="https://en.wikipedia.org/wiki/Mount_Silverthrone" target="_blank">"Mount Silverthrone", Wikipedia, last accessed October 1, 2025, https://en.wikipedia.org/wiki/Mount_Silverthrone.</a></li>
      <li id="bridgeriver_cite"><a href="https://en.wikipedia.org/wiki/Bridge_River_Cones" target="_blank">"Bridge River Cones", Wikipedia, last accessed October 1, 2025, https://en.wikipedia.org/wiki/Bridge_River_Cones.</a></li>
      <li id="meager_cite"><a href="https://en.wikipedia.org/wiki/Mount_Meager_(British_Columbia)" target="_blank">"Mount Meager (British Columbia)", Wikipedia, last accessed October 1, 2025, https://en.wikipedia.org/wiki/Mount_Meager_(British_Columbia).</a></li>
      <li id="cayley_cite"><a href="https://en.wikipedia.org/wiki/Mount_Cayley" target="_blank">"Mount Cayley", Wikipedia, last accessed October 1, 2025, https://en.wikipedia.org/wiki/Mount_Cayley.</a></li>
      <li id="garibaldi_cite"><a href="https://en.wikipedia.org/wiki/Mount_Garibaldi" target="_blank">"Mount Garibaldi", Wikipedia, last accessed October 1, 2025, https://en.wikipedia.org/wiki/Mount_Garibaldi.</a></li>
    </ol>
    <p>
      Created using the <a href="https://github.com/mapbox/storytelling" target="_blank">Mapbox Storytelling</a> template.
      <br>
      <em>Group Members: Charlotte Alarie, Nikolas Hochschild, Ivy Shi</em></p>
  </footer>

  </main>
  
  <script src="config.js"></script>
  <script>
      var initLoad = true;
      var layerTypes = {
          'fill': ['fill-opacity'],
          'line': ['line-opacity'],
          'circle': ['circle-opacity', 'circle-stroke-opacity'],
          'symbol': ['icon-opacity', 'text-opacity'],
          'raster': ['raster-opacity'],
          'fill-extrusion': ['fill-extrusion-opacity'],
          'heatmap': ['heatmap-opacity']
      }

      var alignments = {
          'left': 'lefty',
          'center': 'centered',
          'right': 'righty',
          'full': 'fully'
      }

      function getLayerPaintType(layer) {
          var layerType = map.getLayer(layer).type;
          return layerTypes[layerType];
      }

      function setLayerOpacity(layer) {
          var paintProps = getLayerPaintType(layer.layer);
          paintProps.forEach(function (prop) {
              var options = {};
              if (layer.duration) {
                  var transitionProp = prop + "-transition";
                  options = { "duration": layer.duration };
                  map.setPaintProperty(layer.layer, transitionProp, options);
              }
              map.setPaintProperty(layer.layer, prop, layer.opacity, options);
          });
      }

      var story = document.getElementById('story');
      var features = document.createElement('div');
      features.setAttribute('id', 'features');

      var header = document.createElement('div');

      if (config.title) {
          var titleText = document.createElement('h1');
          titleText.innerText = config.title;
          header.appendChild(titleText);
      }

      if (config.subtitle) {
          var subtitleText = document.createElement('h2');
          subtitleText.innerText = config.subtitle;
          header.appendChild(subtitleText);
      }

      if (config.byline) {
          var bylineText = document.createElement('p');
          bylineText.innerText = config.byline;
          header.appendChild(bylineText);
      }

      if (header.innerText.length > 0) {
          header.classList.add(config.theme);
          header.setAttribute('id', 'header');
          story.appendChild(header);
      }

      config.chapters.forEach((record, idx) => {
          var container = document.createElement('div');
          var chapter = document.createElement('div');

          if (record.title) {
              var title = document.createElement('h3');
              title.innerText = record.title;
              chapter.appendChild(title);
          }

          if (record.image) {
              var image = new Image();
              image.src = record.image;
              chapter.appendChild(image);
          }

          if (record.description) {
              var story = document.createElement('p');
              story.innerHTML = record.description;
              chapter.appendChild(story);
          }

          container.setAttribute('id', record.id);
          container.classList.add('step');
          if (idx === 0) {
              container.classList.add('active');
          }

          chapter.classList.add(config.theme);
          container.appendChild(chapter);
          container.classList.add(alignments[record.alignment] || 'centered');
          if (record.hidden) {
              container.classList.add('hidden');
          }
          features.appendChild(container);
      });

      story.appendChild(features);

      var footer = document.createElement('div');

      if (config.footer) {
          var footerText = document.createElement('p');
          footerText.innerHTML = config.footer;
          footer.appendChild(footerText);
      }

      if (footer.innerText.length > 0) {
          footer.classList.add(config.theme);
          footer.setAttribute('id', 'footer');
          story.appendChild(footer);
      }

      mapboxgl.accessToken = config.accessToken;

      var map = new mapboxgl.Map({
          container: 'map',
          style: config.style,
          center: config.chapters[0].location.center,
          zoom: config.chapters[0].location.zoom,
          bearing: config.chapters[0].location.bearing,
          pitch: config.chapters[0].location.pitch,
          interactive: false,
          projection: config.projection
      });

      // Create a inset map if enabled in config.js
      if (config.inset) {
          map.addControl(
              new GlobeMinimap({ ...config.insetOptions }),
              config.insetPosition
          );
      }

      if (config.showMarkers) {
          var marker = new mapboxgl.Marker({ color: config.markerColor });
          marker.setLngLat(config.chapters[0].location.center).addTo(map);
      }

      // instantiate the scrollama
      var scroller = scrollama();


      map.on("load", function () {
          if (config.use3dTerrain) {
              map.addSource('mapbox-dem', {
                  'type': 'raster-dem',
                  'url': 'mapbox://mapbox.mapbox-terrain-dem-v1', //hosted style id
                  'tileSize': 512,
                  'maxzoom': 14
              });
              // add the DEM source as a terrain layer with exaggerated height
              map.setTerrain({ 'source': 'mapbox-dem', 'exaggeration': 1.5 });

              // add a sky layer that will show when the map is highly pitched
              map.addLayer({
                  'id': 'sky',
                  'type': 'sky',
                  'paint': {
                      'sky-type': 'atmosphere',
                      'sky-atmosphere-sun': [0.0, 0.0],
                      'sky-atmosphere-sun-intensity': 15
                  }
              });
          };

          // setup the instance, pass callback functions
          scroller
              .setup({
                  step: '.step',
                  offset: 0.5,
                  progress: true
              })
              .onStepEnter(async response => {
                  var current_chapter = config.chapters.findIndex(chap => chap.id === response.element.id);
                  var chapter = config.chapters[current_chapter];

                  response.element.classList.add('active');
                  map[chapter.mapAnimation || 'flyTo'](chapter.location);

                  if (config.showMarkers) {
                      marker.setLngLat(chapter.location.center);
                  }
                  if (chapter.onChapterEnter.length > 0) {
                      chapter.onChapterEnter.forEach(setLayerOpacity);
                  }
                  if (chapter.callback) {
                      window[chapter.callback]();
                  }
                  if (chapter.rotateAnimation) {
                      map.once('moveend', () => {
                          const rotateNumber = map.getBearing();
                          map.rotateTo(rotateNumber + 180, {
                              duration: 30000, easing: function (t) {
                                  return t;
                              }
                          });
                      });
                  }
                  if (config.auto) {
                      var next_chapter = (current_chapter + 1) % config.chapters.length;
                      map.once('moveend', () => {
                          document.querySelectorAll('[data-scrollama-index="' + next_chapter.toString() + '"]')[0].scrollIntoView();
                      });
                  }
              })
              .onStepExit(response => {
                  var chapter = config.chapters.find(chap => chap.id === response.element.id);
                  response.element.classList.remove('active');
                  if (chapter.onChapterExit.length > 0) {
                      chapter.onChapterExit.forEach(setLayerOpacity);
                  }
              });


          if (config.auto) {
              document.querySelectorAll('[data-scrollama-index="0"]')[0].scrollIntoView();
          }
      });    
  </script>

</body>

</html>
